<!DOCTYPE html>
<html>
    <head>
        <title>Morse Code Monitor</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style type="text/css">
            body {
                background-color: black;
            } 
        </style>
        <script>
            function setColor(color) {
                document.body.style.background = color;
            }

            var alphabet = {
                'a': '.-', 'b': '-...', 'c': '-.-.', 'd': '-..',
                'e': '.', 'f': '..-.', 'g': '--.', 'h': '....',
                'i': '..', 'j': '.---', 'k': '-.-', 'l': '.-..',
                'm': '--', 'n': '-.', 'o': '---', 'p': '.--.',
                'q': '--.-', 'r': '.-.', 's': '...', 't': '-',
                'u': '..-', 'v': '...-', 'w': '.--', 'x': '-..-',
                'y': '-.--', 'z': '--..', ' ': '/',
                '1': '.----', '2': '..---', '3': '...--', '4': '....-',
                '5': '.....', '6': '-....', '7': '--...', '8': '---..',
                '9': '----.', '0': '-----'
            };

            function encode(str) {
                return str.split('')
                        .map(function (e) {
                            return alphabet[e.toLowerCase()] || '';
                        })
                        .join(' ')
                        .replace(/ +/g, ' ');

            }

            var dot = 300;

            var times = {
                '.': dot,
                '-': dot * 3,
                ' ': dot * 4
            };

            function ditdah(str) {
                return str.split('')
                        .map(function (e) {
                            return times[e.toString()] || '';
                        });
            }

            var position = 0;

            function run(arr) {
                var arrayLength = arr.length;
                for (var i = 0; i < arrayLength; i++) {
                    var starttime = position;
                    var endtime = starttime + arr[i];

                    position = endtime + dot;
                    if (arr[i] === dot * 4) {
                        setTimeout(
                                function () {
                                    setColor('black');
                                }
                        , dot * 3);
                    } else {
                        setTimeout(
                                function () {
                                    setColor('white');
                                }
                        , starttime);
                    }
                    setTimeout(
                            function () {
                                setColor('black');
                            }
                    , endtime);
                }
            }
            
// run these lines below in a web browser console
// var str = 'helloworld';
// var encoded = encode(str);
// var ditdah = ditdah(encoded);
// run(ditdah);
        </script>
    </head>
    <body></body>
</html>
